{"version":3,"sources":["../../src/pages/messages/messages.module.ts","../../src/pipes/pipes.module.ts","../../src/pipes/order-by/order-by.ts","../../src/pipes/reverse/reverse.ts","../../src/pages/messages/messages.ts"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MessagesPage } from './messages';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { MomentModule } from 'angular2-moment';\nimport { PipesModule } from '../../pipes/pipes.module';\n\n@NgModule({\n  declarations: [\n    MessagesPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(MessagesPage),\n    TranslateModule.forChild(),\n    MomentModule,\n    PipesModule\n  ],\n})\nexport class MessagesPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/messages/messages.module.ts","import { NgModule } from '@angular/core';\nimport { OrderByPipe } from './order-by/order-by';\nimport { ReversePipe } from './reverse/reverse';\n\n@NgModule({\n    declarations: [\n    OrderByPipe,\n    ReversePipe,\n  ],\n  imports: [\n\n  ],\n  exports: [\n    OrderByPipe,\n    ReversePipe\n  ]\n})\nexport class PipesModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/pipes.module.ts","import { Pipe, PipeTransform } from '@angular/core';\n\n\n@Pipe({\n  name: 'orderBy',\n})\nexport class OrderByPipe implements PipeTransform {\n\n  static _orderByComparator(a:any, b:any):number{\n\n    if((isNaN(parseFloat(a)) || !isFinite(a)) || (isNaN(parseFloat(b)) || !isFinite(b))){\n      //Isn't a number so lowercase the string to properly compare\n      if(a.toLowerCase() < b.toLowerCase()) return -1;\n      if(a.toLowerCase() > b.toLowerCase()) return 1;\n    }\n    else{\n      //Parse strings as numbers to compare properly\n      if(parseFloat(a) < parseFloat(b)) return -1;\n      if(parseFloat(a) > parseFloat(b)) return 1;\n    }\n\n    return 0; //equal each other\n  }\n\n  transform(input:any, [config = '+'], timeChanged:any): any{\n\n      if(!Array.isArray(input)) return input;\n\n      if(!Array.isArray(config) || (Array.isArray(config) && config.length == 1)){\n          var propertyToCheck:string = !Array.isArray(config) ? config : config[0];\n          var desc = propertyToCheck.substr(0, 1) == '-';\n\n          //Basic array\n          if(!propertyToCheck || propertyToCheck == '-' || propertyToCheck == '+'){\n              return !desc ? input.sort() : input.sort().reverse();\n          }\n          else {\n              var property:string = propertyToCheck.substr(0, 1) == '+' || propertyToCheck.substr(0, 1) == '-'\n                  ? propertyToCheck.substr(1)\n                  : propertyToCheck;\n\n              return input.sort(function(a:any,b:any){\n                  return !desc\n                      ? OrderByPipe._orderByComparator(a[property], b[property])\n                      : -OrderByPipe._orderByComparator(a[property], b[property]);\n              });\n          }\n      }\n      else {\n          //Loop over property of the array in order and sort\n          return input.sort(function(a:any,b:any){\n              for(var i:number = 0; i < config.length; i++){\n                  var desc = config[i].substr(0, 1) == '-';\n                  var property = config[i].substr(0, 1) == '+' || config[i].substr(0, 1) == '-'\n                      ? config[i].substr(1)\n                      : config[i];\n\n                  var comparison = !desc\n                      ? OrderByPipe._orderByComparator(a[property], b[property])\n                      : -OrderByPipe._orderByComparator(a[property], b[property]);\n\n                  //Don't return 0 yet in case of needing to sort by next property\n                  if(comparison != 0) return comparison;\n              }\n\n              return 0; //equal each other\n          });\n      }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/order-by/order-by.ts","import { Pipe, PipeTransform } from '@angular/core';\n\n\n@Pipe({\n  name: 'reverse',\n  pure: false\n})\nexport class ReversePipe implements PipeTransform {\n  transform(value) {\n    return value.slice().reverse();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/reverse/reverse.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\n\nimport { Observable } from 'rxjs/Observable';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs/Subject';\n\nimport { AngularFireAuth } from 'angularfire2/auth';\n\nimport { UserProvider, BuddiesProvider, UtilsProvider, MessagesProvider } from '../../providers';\n\n//https://www.skcript.com/svr/how-to-structure-firebase-database-for-a-scalable-chat-app/\nimport * as moment from 'moment';\n\n@IonicPage()\n@Component({\n  selector: 'page-messages',\n  templateUrl: 'messages.html',\n})\nexport class MessagesPage {\n\n  activeMenu = 'MessagesPage';\n  buddies = [];\n  messages = [];\n  user;\n  timeChanged = 0;\n\n  private ngUnsubscribe:Subject<void> = new Subject();\n\n  constructor(\n    private buddiesProvider: BuddiesProvider,\n    private afAuth: AngularFireAuth,\n    private userProvider: UserProvider,\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public utils: UtilsProvider,\n    public messagesProvider: MessagesProvider\n  ) {\n    console.log(this);\n    this.buddiesProvider.buddies.takeUntil(this.ngUnsubscribe).subscribe((buddies) => {\n      this.buddies = buddies;\n    });\n\n    if(this.userProvider.userObject){\n      this.getMessages(this.userProvider.userObject);\n    }\n\n    this.userProvider.getUser().takeWhile(user => !this.user).subscribe(user => {\n      if(user){\n        this.getMessages(user);\n      }\n    });\n  }\n\n  ionViewWillUnload(){\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n\n  getMessages(user){\n    this.user = user;\n    this.messagesProvider.getAllThreads(this.user.aFuid)\n      .takeUntil(this.ngUnsubscribe)\n      .subscribe( (threads) => {\n        if(!this.messages.length){\n          this.messages = threads;\n          this.fetchUsername(this.messages);\n        }else{\n          this.UpdateMsgList(threads);\n        }\n    });\n  }\n\n\n  UpdateMsgList(newThreads){\n    this.messages.map((thread, index) => {\n      let newThread = newThreads.find(res => res.key == thread.key)\n      if(thread.timestamp != newThread.timestamp || thread.unseenCount != newThread.unseenCount){\n        thread.timestamp = newThread.timestamp;\n        thread.unseenCount = newThread.unseenCount;\n        thread.dateFormat = this.utils.dateTransform(thread.timestamp);\n        this.timeChanged++;\n        return thread;\n      }\n    })\n  }\n\n  fetchUsername(items){\n    items.forEach((thread, index) => {\n      thread.dateFormat = this.utils.dateTransform(thread.timestamp);\n      let bud;\n      if(this.buddies.length && ( bud = this.buddies.find(bud => bud.aFuid == thread.key) ) ){\n        thread.displayName = bud.displayName;\n        thread.profileImgPath = bud.profileImgPath;\n        thread.oneSignalId = bud.oneSignalId;\n      }else{\n        this.buddiesProvider.getUserByID(thread.key)\n          .take(1)\n          .subscribe( (user:any) => {\n            thread.displayName = this.utils.getDisplayName(user);\n            thread.profileImgPath = this.utils.getProfileImg(user);\n            thread.oneSignalId = user.oneSignalId;\n          });\n      }\n    });\n  }\n\n  updateUrl(event: Event, thread) {\n    let index = this.messages.findIndex(res => res.key == thread.key);\n    this.messages[index].profileImgPath = './assets/img/man.svg';\n  }\n\n  showMessage(threadDetails){\n    this.navCtrl.push('MessageThreadPage', {message:threadDetails, me:this.user});\n    setTimeout(() => {\n      this.messageread(threadDetails);\n    }, 400)\n  }\n  messageread(threadDetails){\n    if(threadDetails.unseenCount == 1){\n      this.messagesProvider.messageRead(threadDetails.key);\n    }\n  }\n\n  removeThread(thread){\n    let threadDetails = {\n      from_uid: this.user.aFuid,\n      to_uid: thread.key,\n      threadId: thread.threadId\n    }\n    this.messagesProvider.removeThread(threadDetails);\n    let index = this.messages.findIndex(res => res.key == thread.key);\n    this.messages.splice(index, 1);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/messages/messages.ts"],"sourceRoot":""}