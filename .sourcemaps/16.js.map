{"version":3,"sources":["../../src/pages/places/places.module.ts","../../src/pages/places/places.ts"],"names":[],"mappings":"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","file":"16.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { PlacesPage } from './places';\nimport { TranslateModule } from '@ngx-translate/core';\n\n@NgModule({\n  declarations: [\n    PlacesPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(PlacesPage),\n    TranslateModule.forChild()\n  ],\n  exports: [\n    PlacesPage\n  ]\n})\nexport class PlacesPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/places/places.module.ts","import { Component, ViewChildren } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ModalController, AlertController, FabContainer } from 'ionic-angular';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs/Subject';\n\nimport { UserProvider, PlacesProvider, CaptureProvider, UtilsProvider} from '../../providers';\n\nimport { TranslateService } from '@ngx-translate/core';\nimport { Country } from '../../models';\n\n@IonicPage()\n@Component({\n  selector: 'page-places',\n  templateUrl: 'places.html',\n})\nexport class PlacesPage {\n  @ViewChildren('fab') fabs;\n\n  private ngUnsubscribe:Subject<void> = new Subject(); \n  public countries: ReadonlyArray<any>;\n  places;\n  user;\n  images: Array<any>=[];\n  showSpinner:boolean = true;\n  showNoResult:boolean = false;\n  activeMenu = 'PlacesPage';\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public modalCtrl: ModalController,\n    public userProvider: UserProvider,\n    public placesProvider: PlacesProvider,\n    public utils: UtilsProvider,\n    private capture: CaptureProvider,\n    public translateService: TranslateService,\n    private alertCtrl: AlertController\n  ) {\n    (!this.utils.countries) ? this.utils.getCountries().then(res => this.countries = res) : this.countries = this.utils.countries;\n\n    this.userProvider.afAuth.authState.takeUntil(this.ngUnsubscribe).subscribe((user) => {\n      if(user){\n        this.user = user.toJSON();\n        this.placesProvider.getAllByUser(this.user.uid).takeUntil(this.ngUnsubscribe).subscribe((data) => {\n          this.places = data;\n          this.places.map(place => place.countryName = this.utils.getCountry(place.country, this.countries))\n          this.showNoResult = (data.length < 1) ? true : false ;\n          this.showSpinner = false;\n        });\n      }\n    });\n  }\n\n  ionViewDidLeave(){\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n\n  pathForImage(img){\n    return this.capture.pathForImage('letsride/'+this.user.uid+'/'+img);\n  }\n\n\n  presentModal(state: string, key: string = null, fab: FabContainer){\n\n    let page = 'PlacesModalPage';\n    if(state == 'create' || state == 'display_place'){\n      page = 'MapPage';\n    }\n    let modal = this.modalCtrl.create('ModalNavPage', {\n      state: state,\n      key: key,\n      values: (key) ? this.places.filter( place => place.key === key)[0] : null,\n      page: page,\n      userId: this.user.uid\n    })\n\n    modal.onDidDismiss(data => {\n      if(data != null && data.state != 'cancel'){\n        switch(data.state) {\n          case \"create\": {\n            this.add({...data.value, ...{userId: this.user.uid}})\n            break;\n          }\n          case \"update\": {\n            this.update(data.key, data.value)\n            break;\n          }\n        }\n      }\n    });\n\n\n    modal.present();\n    if(fab){\n      fab.close();\n    }\n  }\n\n  add(item: any) {\n    this.placesProvider.add(item);\n  }\n  update(key: string, props: any) {\n    //props = { name: 'new name' }\n    this.placesProvider.update(key, props);\n  }\n  delete(key: string, fab: FabContainer) {\n\n    let confirm = this.alertCtrl.create({\n      title: 'Deleting !',\n      message: 'You are going to permanently delete this place !',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: () => {\n            fab.close();\n          }\n        },\n        {\n          text: 'Delete',\n          handler: () => {\n            this.placesProvider.delete(key);\n          }\n        }\n      ]\n    });\n    confirm.present();\n  }\n\n  deleteEverything() {\n    this.placesProvider.deleteEverything();\n  }\n\n\n  closeFabs(fab: FabContainer){\n    this.fabs\n      .filter((_fab) => _fab != fab )\n      .forEach((_fab:FabContainer) => _fab.close())\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/places/places.ts"],"sourceRoot":""}